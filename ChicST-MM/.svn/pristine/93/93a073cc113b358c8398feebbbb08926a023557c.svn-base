@model ChicST_MM.WEB.Models.BusinessReceiving_RecordsViewModel
@{
    ViewBag.Title = "接待申请表";
}
<style>
    .tab tbody tr td:nth-child(2n-1) {
        text-align: center;
        width: auto;
    }
</style>
<script>
    $(function () {

        //加载关联审核人下拉框数据
        $.ajax({
            type: "post",
            data: {},
            url: '@Url.Action("GetAssociatedAuditor", "BusinessReceiving")',
            dataType: "json",
            cache: false,
            async: true,
            success: function (data) {
                $("#reviewer").empty();
                $("#reviewer").append("<option value=''>-请选择审核人-</option>")
                $.each(data, (i, m) => {
                    $("#reviewer").append("<option value=" + m[0] + ">" + m[1] + "</option>");

                })

            },
            error: function(err){
                console.log(err)
            }

        })

    })
  
</script>

<h3>接待申请表</h3>

@*主表信息*@
<input type="text" name="" value="" id="recPlanID"/>
<form  id="MainForm">
    <table class="table table-striped table-bordered table-hover">

        <tr>
            <td class="bold">申请人</td>
            <td>@Model.申请人
                <input type="text" name="申请人ID" value="@Model.申请人ID" class=" hidden" readonly />
            </td>
            <td class="bold">部门</td>
            <td>
                <input type="text" name="部门" value="@Model.部门" class="form-control" readonly/>
            </td>
        </tr>
        <tr>
            <td class="bold">入住酒店</td>
            <td>
                <input type="text" name="入住酒店" class="form-control red" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
            <td class="bold">航班号</td>
            <td colspan="3">
                <input type="text" name="航班号" class="form-control red" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
        </tr>
        <tr>
            <td class="bold">关联审核人</td>
            <td colspan="3">
                <select name="审核人ID" id="reviewer" class="form-control red" oninput="sureRed()">
                    <option>-请选择审核人-</option>
                </select>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
        </tr>
        <tr>
            <td colspan="4" class="" style="position:relative;">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 start-date">
                    <span class="bold">抵达日期</span>&nbsp;&nbsp;
                    <input name="抵达日期" class="dateTime search-input red" type='text' placeholder="请选择开始日期" oninput="sureRed()" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>

                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <span class="bold">离开日期</span>&nbsp;&nbsp;
                    <input name="离开日期" class="dateTime search-input red" type='text' placeholder="请选择结束日期" oninput="sureRed()" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>
            </td>
        </tr>
        <tr>
            <td class="bold">主要沟通内容</td>
            <td colspan="3">
                <textarea rows="3" name="主要沟通内容" class="form-control red" oninput="sureRed()"></textarea>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
        </tr>

        <tr>
            <td class="bold">费用总预算</td>
            <td>
                <input name="费用总预算" type="text" class="form-control red"
                       onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" value="0" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
            <td class="bold">配合部门</td>
            <td>
                <input name="配合部门" type="text" class="form-control red" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </td>
        </tr>

    </table>
    <div class="submit-btns" style="margin-top:10px;">
        <input type="button" name="name" value="下一步"id="mainNext"/>
    </div>
</form>
@*修改主表信息*@
@*<form action="@Url.Action("ReceivingRecordsEdit","BusinessReceiving")" method="post" id="MainFormEdit">
    <table class="table table-striped table-bordered table-hover">

        <tr>
            <td class="bold">申请人</td>
            <td>
                @Model.申请人
            <input type="text" name="申请人ID" value="@Model.申请人ID" class=" hidden" readonly />
        </td>
        <td class="bold">部门</td>
        <td>
            <input type="text" name="部门" value="@Model.部门" class="form-control" readonly />
        </td>
    </tr>
    <tr>
        <td class="bold">入住酒店</td>
        <td>
            <input type="text" name="入住酒店" class="form-control red" oninput="sureRed()" value="@Model.入住酒店"/>
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
        <td class="bold">航班号</td>
        <td colspan="3">
            <input type="text" name="航班号" class="form-control red" oninput="sureRed()" value="@Model.航班号"/>
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
    </tr>
    <tr>
        <td class="bold">关联审核人</td>
        <td colspan="3">
            <select name="审核人ID" id="reviewer" class="form-control red" oninput="sureRed()">
                <option>-请选择审核人-</option>
            </select>
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
    </tr>
    <tr>
        <td colspan="4" class="" style="position:relative;">
            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 start-date">
                <span class="bold">抵达日期</span>&nbsp;&nbsp;
                <input name="抵达日期" class="dateTime search-input red" type='text' placeholder="请选择抵达日期" oninput="sureRed()" value="@Model.抵达日期"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </div>

            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <span class="bold">离开日期</span>&nbsp;&nbsp;
                <input name="离开日期" class="dateTime search-input red" type='text' placeholder="请选择离开日期" oninput="sureRed()" value="@Model.离开日期"/>
                <span class="must" style="color:red;">*该选项为必填项</span>
            </div>
        </td>
    </tr>
    <tr>
        <td class="bold">主要沟通内容</td>
        <td colspan="3">
            <textarea rows="3" name="主要沟通内容" class="form-control red" oninput="sureRed()">@Model.主要沟通内容</textarea>
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
    </tr>

    <tr>
        <td class="bold">费用总预算</td>
        <td>
            <input name="费用总预算" type="text" class="form-control red"
                   onkeyup="value=value.replace(/[^\d.]/g,'')"
                   onblur="value=value.replace(/[^\d.]/g,'')" value="@Model.费用总预算" oninput="sureRed()" />
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
        <td class="bold">配合部门</td>
        <td>
            <input name="配合部门" type="text" class="form-control red" oninput="sureRed()" value="@Model.配合部门"/>
            <span class="must" style="color:red;">*该选项为必填项</span>
        </td>
    </tr>

</table>
<div class="submit-btns" style="margin-top:10px;">
    <input type="button" value="确认修改" onclick="sureMainEdit()" />
</div>
</form>*@
@*接待来宾信息模态框*@
<h3>接待来宾信息模态框</h3>
<div id="ReceptionInfo-diolog">
    <table class="table table-bordered table-hover table-striped tab">

        <tr>
            <td>身份</td>
            <td>
                <input type="text" class="form-control" id="identity" />
            </td>
        </tr>
        <tr>
            <td>姓名</td>
            <td>
                <input type="text" class="form-control" id="recName" />
            </td>
        </tr>
        <tr>
            <td>性别</td>
            <td>
                <input type="text" class="form-control" id="recGender" />
            </td>
        </tr>
        <tr>
            <td>电话</td>
            <td>
                <input type="text" class="form-control" id="recPhone" />
            </td>
        </tr>
        <tr>
            <td>备注</td>
            <td>
                <input type="text" class="form-control" id="infoNotes" />
            </td>
        </tr>
    </table>
</div>
@*修改*@
<div id="ReceptionInfo-diologE">
    <table class="table table-bordered table-hover table-striped tab">

        <tr>
            <td>身份</td>
            <td>
                <input type="text" class="form-control" id="identityE" />
            </td>
        </tr>
        <tr>
            <td>姓名</td>
            <td>
                <input type="text" class="form-control" id="recNameE" />
            </td>
        </tr>
        <tr>
            <td>性别</td>
            <td>
                <input type="text" class="form-control" id="recGenderE" />
            </td>
        </tr>
        <tr>
            <td>电话</td>
            <td>
                <input type="text" class="form-control" id="recPhoneE" />
            </td>
        </tr>
        <tr>
            <td>备注</td>
            <td>
                <input type="text" class="form-control" id="infoNotesE" />
            </td>
        </tr>
    </table>
</div>
@*接待来宾信息表格*@
<div style="margin: 0 auto; width:95%;">
    <div style="text-align:start; margin-bottom:10px;">
        <input id="AddReceptionInfo" type="button" value="添加来宾信息" class="btn " />
        <sapn style="color: orange;display: block;margin: 5px 0 5px 0;">温馨提示：添加后请点击确定</sapn>
    </div>
    <table id="ReceptionInfo-grid"></table>
    <div id="ReceptionInfo-pager"></div>
</div>

@*商务接待计划详情模态框*@
<h3>商务接待计划详情模态框</h3>
<div id="recDetailPlan-diolog">
    <table class="table table-bordered table-hover table-striped">
        <tr>
            <td>日期</td>
            <td>
                <input type="text" value="" class="search-input dateTime" placeholder="请选择日期" id="detailDate" />
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 start-date">
                    <span class="bold">开始时间</span>&nbsp;&nbsp;
                    <input class="timeLay search-input" type='text' placeholder="请选择开始时间" oninput="sureRed()" id="detailStart" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>

                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <span class="bold">结束时间</span>&nbsp;&nbsp;
                    <input class="timeLay search-input" type='text' placeholder="请选择结束时间" oninput="sureRed()" id="detailEnd" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>
            </td>
        </tr>
        <tr>
            <td>行程项目</td>
            <td>
                <input type="text" value="" class="form-control" id="travelProj" />
            </td>
        </tr>
        <tr>
            <td>陪同人员</td>
            <td>
                <input type="text" value="" class="form-control" id="withPerson" />
            </td>
        </tr>
        <tr>
            <td>准备的资料</td>
            <td>
                <textarea rows="3" class="form-control" id="preparedData"></textarea>
            </td>
        </tr>
        <tr>
            <td>车辆配备数</td>
            <td>
                <input type="text" value="" class="form-control" id="carNum" />
            </td>
        </tr>
        <tr>
            <td>会谈地点</td>
            <td>
                <input type="text" value="" class="form-control" id="talksite" />
            </td>
        </tr>
        <tr>
            <td>会谈重点项目</td>
            <td>
                <input type="text" value="" class="form-control" id="talkKey" />
            </td>
        </tr>
    </table>
</div>
@*修改*@
<div id="recDetailPlan-diologE">
    <table class="table table-bordered table-hover table-striped">
        <tr>
            <td>日期</td>
            <td>
                <input type="text" value="" class="search-input dateTime" placeholder="请选择日期" id="detailDateE" />
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 start-date">
                    <span class="bold">开始时间</span>&nbsp;&nbsp;
                    <input class="timeLay search-input" type='text' placeholder="请选择开始时间" oninput="sureRed()" id="detailStartE" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>

                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                    <span class="bold">结束时间</span>&nbsp;&nbsp;
                    <input class="timeLay search-input" type='text' placeholder="请选择结束时间" oninput="sureRed()" id="detailEndE" />
                    <span class="must" style="color:red;">*该选项为必填项</span>
                </div>
            </td>
        </tr>
        <tr>
            <td>行程项目</td>
            <td>
                <input type="text" value="" class="form-control" id="travelProjE" />
            </td>
        </tr>
        <tr>
            <td>陪同人员</td>
            <td>
                <input type="text" value="" class="form-control" id="withPersonE" />
            </td>
        </tr>
        <tr>
            <td>准备的资料</td>
            <td>
                <textarea rows="3" class="form-control" id="preparedDataE"></textarea>
            </td>
        </tr>
        <tr>
            <td>车辆配备数</td>
            <td>
                <input type="text" value="" class="form-control" id="carNumE" />
            </td>
        </tr>
        <tr>
            <td>会谈地点</td>
            <td>
                <input type="text" value="" class="form-control" id="talksiteE" />
            </td>
        </tr>
        <tr>
            <td>会谈重点项目</td>
            <td>
                <input type="text" value="" class="form-control" id="talkKeyE" />
            </td>
        </tr>
    </table>
</div>
@**表格*@
<div style="margin: 0 auto; width:95%;">
    <div style="text-align:start; margin-bottom:10px;">
        <input id="AddrecDetailPlan" type="button" value="添加接待计划详情" class="btn " />
        <sapn style="color: orange;display: block;margin: 5px 0 5px 0;">温馨提示：添加后请点击确定</sapn>
    </div>
    <table id="recDetailPlan-grid"></table>
    <div id="recDetailPlan-pager"></div>
</div>
@*会谈事项模态框*@
<h3>会谈事项模态框</h3>
<div id="talkMatters-diolog">
    <table class="table table-bordered table-hover table-striped">

        <tr>
            <td>主要问题</td>
            <td>
                <textarea rows="3" class="form-control" id="problemKey"></textarea>
            </td>
        </tr>
        <tr>
            <td>计划应对方案</td>
            <td>
                <textarea rows="3" class="form-control" id="planProject "></textarea>
            </td>
        </tr>
        <tr>
            <td>预计成果</td>
            <td>
                <input type="text" value="" class="form-control" id="ExpResults" />
            </td>
        </tr>
        <tr>
            <td>需要的协助</td>
            <td>
                <textarea rows="3" class="form-control" id="needHelp"></textarea>
            </td>
        </tr>
    </table>
</div>
@*修改*@
<div id="talkMatters-diologE">
    <table class="table table-bordered table-hover table-striped">

        <tr>
            <td>主要问题</td>
            <td>
                <textarea rows="3" class="form-control" id="problemKeyE"></textarea>
            </td>
        </tr>
        <tr>
            <td>计划应对方案</td>
            <td>
                <textarea rows="3" class="form-control" id="planProjectE "></textarea>
            </td>
        </tr>
        <tr>
            <td>预计成果</td>
            <td>
                <input type="text" value="" class="form-control" id="ExpResultsE" />
            </td>
        </tr>
        <tr>
            <td>需要的协助</td>
            <td>
                <textarea rows="3" class="form-control" id="needHelpE"></textarea>
            </td>
        </tr>
    </table>
</div>
<div style="margin: 0 auto; width:95%;">
    <div style="text-align:start; margin-bottom:10px;">
        <input id="AddtalkMatters" type="button" value="添加会议事项" class="btn " />
        <sapn style="color: orange;display: block;margin: 5px 0 5px 0;">温馨提示：添加后请点击确定</sapn>
    </div>
    <table id="talkMatters-grid"></table>
    <div id="talkMatters-pager"></div>
</div>
@*接待预算模态框*@
<h3>接待预算模态框</h3>
<div id="RecBudget-diolog">
    <table class="table table-bordered table-hover table-striped tab">
        <tr>
            <td>时间</td>
            <td>
                <input type="text" value="" class=" form-control dateTime" placeholder="请选择日期" id="recBudDate" />
            </td>
        </tr>
        <tr>
            <td>摘要</td>
            <td>
                <textarea rows="3" class="form-control" id="digest"></textarea>
            </td>
        </tr>
        <tr>
            <td>金额预算</td>
            <td>
                <input type="text" class="form-control" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" value="0" id="budMoney" />
            </td>
        </tr>

    </table>
</div>
@*修改*@
<div id="RecBudget-diologE">
    <table class="table table-bordered table-hover table-striped tab">
        <tr>
            <td>时间</td>
            <td>
                <input type="text" value="" class=" form-control dateTime" placeholder="请选择日期" id="recBudDateE" />
            </td>
        </tr>
        <tr>
            <td>摘要</td>
            <td>
                <textarea rows="3" class="form-control" id="digestE"></textarea>
            </td>
        </tr>
        <tr>
            <td>金额预算</td>
            <td>
                <input type="text" class="form-control" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" value="0" id="budMoneyE" />
            </td>
        </tr>

    </table>
</div>
<div style="margin: 0 auto; width:95%;">
    <div style="text-align:start; margin-bottom:10px;">
        <input id="AddReceptionBudget" type="button" value="添加接待预算" class="btn " />
        <sapn style="color: orange;display: block;margin: 5px 0 5px 0;">温馨提示：添加后请点击确定</sapn>
    </div>
    <table id="RecBudget-grid"></table>
    <div id="RecBudget-pager"></div>
</div>



<script>
    
        //接待计划ID
        var recPlanID = "";
          //点击主表后的提交
        $("#mainNext").click(function() {
            var MainStatus = false;
            $("#MainForm .red").each((i, m) => {
                if (m.value == "" || m.value == null) {
                    return MainStatus = true;
                }
            })
            if (MainStatus) {
                alert("请完善信息！")
            } else {
           
                 $.ajax({
                    type: "post",
                     url: '@Url.Action("ReceivingRecordsAdd", "BusinessReceiving")',
                     data: $("#MainForm").serialize(),
                    dataType: "json",
                    cache: false,
                    async: true,
                     success: function (data) {
                         //console.log(data.id);
                         $("#recPlanID").val(data.id);//接待计划ID
                         recPlanID = data.id;
                         console.log(recPlanID);
                   
                    },
                    error: function(err){
                        console.log(err)
                    }

                })
          
            }

        })
        console.log(recPlanID);
        

       @************ 接待来宾信息 **************@
        //jqgrid表格配置
        jQuery("#ReceptionInfo-grid").jqGrid({
            url: "",
            datatype: "local",//显示数据

            mtype: "post",
            colModel: [
                { label: 'ID', name: 'ID', index: 'ID', sorttype: "int", width: 50, align: "center" },
                { label: '身份', name: '身份', index: '身份', sortable: false, align: "center" },
                { label: '姓名', name: '姓名', index: '姓名', sortable: false, align: "center" },
                { label: '性别', name: '性别', index: '性别', sortable: false, align: "center" },
                { label: '电话', name: '电话', index: '电话', sortable: false, align: "center" },
                { label: '备注', name: '备注', index: '备注', sortable: false, align: "center" },
                { label: '修改', name: 'Edit', index: 'id', width: 80, align: "center" },
                { label: '删除', name: 'Delete', index: 'id', sortable: false, align: "center" },

            ],
            caption: "接待来宾信息展示",
            loadonce: true,    //排序翻页等操作在服务端完成
            //rowNum: 5,
            //rowList: [5, 10, 20],  //设置分页下拉列表
            pager: "#ReceptionInfo-pager",
            viewrecords: true,
            width: 500, height: "auto",
            jsonReader: { repeatitems: false }, //prmNames: { id: "No" },
            sortorder: "asc",
            sortname: "No",//传递给服务端的排序字段名
            autowidth: true,
            gridComplete: function () {  //在此事件中循环为每一行添加删除/修改链接
                var ids = jQuery("#ReceptionInfo-grid").jqGrid('getDataIDs');

                for (var i = 0; i < ids.length; i++) {

                    var rowId = ids[i];
                    // 通过当前行id获取所需ID
                    var rowData = $("#ReceptionInfo-grid").jqGrid('getRowData', rowId);
                    var id = rowData.ID;
                    //console.log(rowId)
                    edit = "<a href='#'  style='color:#f60' onclick='InfoEdit(" + id + "," + rowId + ")' >修改</a>";
                    del = "<a href='#'  style='color:#f60' onclick='InfoDelete(" + id + "," + rowId + ")' >删除</a>";
                    jQuery("#ReceptionInfo-grid").jqGrid('setRowData', ids[i], { Edit: edit, Delete: del });

                }
            }
        });
        // 点击添加打开模态框
        $("#AddReceptionInfo")
            .click(function () {
                $("#ReceptionInfo-diolog").dialog("option", "title", "接待来宾信息填写").dialog("open");
            });
        //接待来宾模态框
        $("#ReceptionInfo-diolog").dialog({
            autoOpen: false,
            height: 400,
            width: 400,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {

                    var selectedId = $("#ReceptionInfo-grid").jqGrid("getGridParam", "selrow");
                    var actionUrl = "";
                    var params = {

                    };

                    $("#ReceptionInfo-diolog .red").each((i, m) => {
                        if (m.value == null || m.value == "") {
                            return status = true;
                        }
                    })
                    if (status) {
                        alert("请完善信息！")
                    }
                    else {
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                                // 如果提交成功就显示在页面
                                if (data.Success) {
                                    var dataRow = {

                                    };
                                    console.log(dataRow)
                                    if (selectedId) {
                                        $("#ReceptionInfo-grid").jqGrid("addRowData", data.businessid, dataRow, "before", selectedId);//如果有选定行则添加在选定行前面
                                    } else {
                                        $("#ReceptionInfo-grid").jqGrid("addRowData", data.businessid, dataRow, "last");//没有选定行则添加在第一行
                                    }
                                    // 添加成功模态框关闭
                                    $("#ReceptionInfo-diolog").dialog("close");
                                    alert("添加操作成功!");
                                } else {
                                    alert("添加操作失败!");
                                }

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    }

                }
            }
        });
        //修改模态框
        $("#ReceptionInfo-diologE").dialog({
            autoOpen: false,
            height: 400,
            width: 400,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {
                    
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                                // 如果提交成功就显示在页面
                               
                                // 修改成功模态框关闭
                                $("#ReceptionInfo-diologE").dialog("close");
                                alert("修改操作成功!");
                               
                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    

                }
            }
        });

        @************ 商务接待计划详情 **************@
        //jqgrid表格配置
        jQuery("#recDetailPlan-grid").jqGrid({
            url: "",
            datatype: "local",//显示数据

            mtype: "post",
            colModel: [
                { label: 'ID', name: 'ID', index: 'ID', sorttype: "int", width: 50, align: "center" },
                { label: '日期', name: '日期', index: '日期', sortable: false, align: "center" },
                { label: '开始时间', name: '开始时间', index: '开始时间', sortable: false, align: "center" },
                { label: '结束时间', name: '结束时间', index: '结束时间', sortable: false, align: "center" },
                { label: '行程项目', name: '行程项目', index: '行程项目', sortable: false, align: "center" },
                { label: '陪同人员', name: '陪同人员', index: '陪同人员', sortable: false, align: "center" },
                { label: '准备的资料', name: '准备的资料', index: '准备的资料', sortable: false, align: "center" },
                { label: '车辆配备数', name: '车辆配备数', index: '车辆配备数', sortable: false, align: "center" },
                { label: '会谈地点', name: '会谈地点', index: '会谈地点', sortable: false, align: "center" },
                { label: '会谈重点项目', name: '会谈重点项目', index: '会谈重点项目', sortable: false, align: "center" },
                { label: '修改', name: 'Edit', index: 'id', width: 80, align: "center" },
                { label: '删除', name: 'Delete', index: 'id', sortable: false, align: "center" },



            ],
            caption: "接待计划展示",
            loadonce: true,    //排序翻页等操作在服务端完成
            //rowNum: 5,
            //rowList: [5, 10, 20],  //设置分页下拉列表
            pager: "#recDetailPlan-pager",
            viewrecords: true,
            width: 500, height: "auto",
            jsonReader: { repeatitems: false }, //prmNames: { id: "No" },
            sortorder: "asc",
            sortname: "No",//传递给服务端的排序字段名
            autowidth: true,
            gridComplete: function () {  //在此事件中循环为每一行添加删除/修改链接
                var ids = jQuery("#recDetailPlan-grid").jqGrid('getDataIDs');

                for (var i = 0; i < ids.length; i++) {

                    var rowId = ids[i];
                    // 通过当前行id获取所需ID
                    var rowData = $("#recDetailPlan-grid").jqGrid('getRowData', rowId);
                    var id = rowData.ID;
                    //console.log(rowId)
                    edit = "<a href='#'  style='color:#f60' onclick='DetailPlanEdit(" + id + "," + rowId + ")' >修改</a>";
                    del = "<a href='#'  style='color:#f60' onclick='DetailPlanDelete(" + id + "," + rowId + ")' >删除</a>";
                    jQuery("#recDetailPlan-grid").jqGrid('setRowData', ids[i], { Edit: edit, Delete: del });

                }
            }
        });
        // 点击添加打开模态框
        $("#AddrecDetailPlan")
            .click(function () {
                $("#recDetailPlan-diolog").dialog("option", "title", "接待计划详情填写").dialog("open");
            });
        //商务接待计划详情模态框
        $("#recDetailPlan-diolog").dialog({
            autoOpen: false,
            height: 650,
            width: 960,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {
                    
                    var detailDate   = $.trim($("#detailDate").val());//日期
                    var detailStart  = $.trim($("#detailStart").val());//开始时间
                    var detailEnd    = $.trim($("#detailEnd").val());//结束时间
                    var travelProj   = $.trim($("#travelProj").val());//行程项目
                    var withPerson   = $.trim($("#withPerson").val());//陪同人员
                    var preparedData = $.trim($("#preparedData").val());//准备的资料
                    var carNum       = $.trim($("#carNum").val());//车辆配备数
                    var talksite     = $.trim($("#talksite").val());//会谈地点
                    var talkKey      = $.trim($("#talkKey").val());//会谈重点项目


                    var selectedId = $("#recDetailPlan-grid").jqGrid("getGridParam", "selrow");
                    var actionUrl = "@Url.Action("BusinessRec_PlanAdd", "BusinessReceiving")";
                    var params = {
                        "接待计划ID":recPlanID,
                        "日期": detailDate,
                        "开始时间": detailStart,
                        "结束时间": detailEnd,
                        "行程项目": travelProj,
                        "陪同人员": withPerson,
                        "准备的资料": preparedData,
                        "车辆配备数": carNum,
                        "会谈地点": talksite,
                        "会谈重点项目": talkKey,

                    };

                    $("#ReceptionInfo-diolog .red").each((i, m) => {
                        if (m.value == null || m.value == "") {
                            return status = true;
                        }
                    })
                    if (status) {
                        alert("请完善信息！")
                    }
                    else {
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                console.log(data)
                                // 如果提交成功就显示在页面
                                if (data.success) {
                                   
                                    var dataRow = {
                                        "ID": newid,
                                        "日期": detailDate,
                                        "开始时间": detailStart,
                                        "结束时间": detailEnd,
                                        "行程项目": travelProj,
                                        "陪同人员": withPerson,
                                        "准备的资料": preparedData,
                                        "车辆配备数": carNum,
                                        "会谈地点": talksite,
                                        "会谈重点项目": talkKey,
                                    };
                                    console.log(dataRow)
                                    $("#recDetailPlan-grid").jqGrid("addRowData", newid, dataRow, "last");//没有选定行则添加在第一行
                                   
                                    // 添加成功模态框关闭
                                    $("#ReceptionInfo-diolog").dialog("close");
                                    alert("添加操作成功!");
                                } else {
                                    alert("添加操作失败!");
                                }

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    }

                }
            }
        });
        //修改
        $("#recDetailPlan-diologE").dialog({
            autoOpen: false,
            height: 650,
            width: 960,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {
                    
                        //提交模态框的数据
                        $.ajax({
                            url: '',
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                               
                                    // 添加成功模态框关闭
                                    $("#ReceptionInfo-diologE").dialog("close");
                                    alert("修改操作成功!");
                                

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    

                }
            }
        });
        @************ 会谈事项 **************@

        //jqgrid表格配置
        jQuery("#talkMatters-grid").jqGrid({
            url: "",
            datatype: "local",//显示数据

            mtype: "post",
            colModel: [
                { label: 'ID', name: 'ID', index: 'ID', sorttype: "int", width: 50, align: "center" },
                { label: '主要问题', name: '主要问题', index: '主要问题', sortable: false, align: "center" },
                { label: '计划应对方案', name: '计划应对方案', index: '计划应对方案', sortable: false, align: "center" },
                { label: '预计成果', name: '预计成果', index: '预计成果', sortable: false, align: "center" },
                { label: '需要的协助', name: '需要的协助', index: '需要的协助', sortable: false, align: "center" },
                { label: '修改', name: 'Edit', index: 'id', width: 80, align: "center" },
                { label: '删除', name: 'Delete', index: 'id', sortable: false, align: "center" },



            ],
            caption: "会议事项展示",
            loadonce: true,    //排序翻页等操作在服务端完成
            //rowNum: 5,
            //rowList: [5, 10, 20],  //设置分页下拉列表
            pager: "#talkMatters-pager",
            viewrecords: true,
            width: 500, height: "auto",
            jsonReader: { repeatitems: false }, //prmNames: { id: "No" },
            sortorder: "asc",
            sortname: "No",//传递给服务端的排序字段名
            autowidth: true,
            gridComplete: function () {  //在此事件中循环为每一行添加删除/修改链接
                var ids = jQuery("#talkMatters-grid").jqGrid('getDataIDs');

                for (var i = 0; i < ids.length; i++) {

                    var rowId = ids[i];
                    // 通过当前行id获取所需ID
                    var rowData = $("#talkMatters-grid").jqGrid('getRowData', rowId);
                    var id = rowData.ID;
                    //console.log(rowId)
                    edit = "<a href='#'  style='color:#f60' onclick='talkMattersEdit(" + id + "," + rowId + ")' >修改</a>";
                    del = "<a href='#'  style='color:#f60' onclick='talkMattersDelete(" + id + "," + rowId + ")' >删除</a>";
                    jQuery("#talkMatters-grid").jqGrid('setRowData', ids[i], { Edit: edit, Delete: del });

                }
            }
        });

        // 点击添加打开模态框
        $("#AddtalkMatters")
            .click(function () {
                $("#talkMatters-diolog").dialog("option", "title", "会议事项填写").dialog("open");
            });
        //会谈事项模态框
        $("#talkMatters-diolog").dialog({
            autoOpen: false,
            height: 550,
            width: 860,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {

                    var selectedId = $("#talkMatters-grid").jqGrid("getGridParam", "selrow");
                    var actionUrl = "";
                    var params = {

                    };

                    $("#talkMatters-diolog .red").each((i, m) => {
                        if (m.value == null || m.value == "") {
                            return status = true;
                        }
                    })
                    if (status) {
                        alert("请完善信息！")
                    }
                    else {
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                                // 如果提交成功就显示在页面
                                if (data.Success) {
                                    var dataRow = {

                                    };
                                    console.log(dataRow)
                                    if (selectedId) {
                                        $("#talkMatters-grid").jqGrid("addRowData", data.businessid, dataRow, "before", selectedId);//如果有选定行则添加在选定行前面
                                    } else {
                                        $("#talkMatters-grid").jqGrid("addRowData", data.businessid, dataRow, "last");//没有选定行则添加在第一行
                                    }
                                    // 添加成功模态框关闭
                                    $("#talkMatters-diolog").dialog("close");
                                    alert("添加操作成功!");
                                } else {
                                    alert("添加操作失败!");
                                }

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    }

                }
            }
        });
        //修改
        $("#talkMatters-diologE").dialog({
            autoOpen: false,
            height: 550,
            width: 860,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {

                        //提交模态框的数据
                        $.ajax({
                            url: '',
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                                // 添加成功模态框关闭
                                $("#talkMatters-diologE").dialog("close");
                                alert("添加操作成功!");
                               

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    

                }
            }
        });



        @************ 接待预算 **************@

        //jqgrid表格配置
        jQuery("#RecBudget-grid").jqGrid({
            url: "",
            datatype: "local",//显示数据

            mtype: "post",
            colModel: [
                { label: 'ID', name: 'ID', index: 'ID', sorttype: "int", width: 50, align: "center" },
                { label: '时间', name: '时间', index: '时间', sortable: false, align: "center" },
                { label: '摘要', name: '摘要', index: '摘要', sortable: false, align: "center" },
                { label: '金额预算', name: '金额预算', index: '金额预算', sortable: false, align: "center" },
                { label: '修改', name: 'Edit', index: 'id', width: 80, align: "center" },
                { label: '删除', name: 'Delete', index: 'id', sortable: false, align: "center" },



            ],
            caption: "接待预算展示",
            loadonce: true,    //排序翻页等操作在服务端完成
            //rowNum: 5,
            //rowList: [5, 10, 20],  //设置分页下拉列表
            pager: "#RecBudget-pager",
            viewrecords: true,
            width: 500, height: "auto",
            jsonReader: { repeatitems: false }, //prmNames: { id: "No" },
            sortorder: "asc",
            sortname: "No",//传递给服务端的排序字段名
            autowidth: true,
            gridComplete: function () {  //在此事件中循环为每一行添加删除/修改链接
                var ids = jQuery("#RecBudget-grid").jqGrid('getDataIDs');

                for (var i = 0; i < ids.length; i++) {

                    var rowId = ids[i];
                    // 通过当前行id获取所需ID
                    var rowData = $("#RecnBudget-grid").jqGrid('getRowData', rowId);
                    var id = rowData.ID;
                    //console.log(rowId)
                    edit = "<a href='#'  style='color:#f60' onclick='RecBudEdit(" + id + "," + rowId + ")' >修改</a>";
                    del = "<a href='#'  style='color:#f60' onclick='RecBudDelete(" + id + "," + rowId + ")' >删除</a>";
                    jQuery("#RecBudget-grid").jqGrid('setRowData', ids[i], { Edit: edit, Delete: del });

                }
            }
        });
        // 点击添加打开模态框
        $("#AddReceptionBudget")
            .click(function () {
                $("#ReceptionBudget-diolog").dialog("option", "title", "接待预算填写").dialog("open");
            });
        //接待预算模态框
        $("#RecBudget-diolog").dialog({
            autoOpen: false,
            height: 400,
            width: 500,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {

                    var selectedId = $("#RecBudget-grid").jqGrid("getGridParam", "selrow");
                    var actionUrl = "";
                    var params = {

                    };

                    $("#RecBudget-diolog .red").each((i, m) => {
                        if (m.value == null || m.value == "") {
                            return status = true;
                        }
                    })
                    if (status) {
                        alert("请完善信息！")
                    }
                    else {
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                                // 如果提交成功就显示在页面
                                if (data.Success) {
                                    var dataRow = {

                                    };
                                    console.log(dataRow)
                                    if (selectedId) {
                                        $("#RecBudget-grid").jqGrid("addRowData", data.businessid, dataRow, "before", selectedId);//如果有选定行则添加在选定行前面
                                    } else {
                                        $("#RecBudget-grid").jqGrid("addRowData", data.businessid, dataRow, "last");//没有选定行则添加在第一行
                                    }
                                    // 添加成功模态框关闭
                                    $("#RecBudget-diolog").dialog("close");
                                    alert("添加操作成功!");
                                } else {
                                    alert("添加操作失败!");
                                }

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    }

                }
            }
        });
        //修改
        $("#RecBudget-diologE").dialog({
            autoOpen: false,
            height: 400,
            width: 500,
            modal: true,
            buttons: {

                "取消": function () { $(this).dialog("close") },
                "提交": function () {
                    
                        //提交模态框的数据
                        $.ajax({
                            url: actionUrl,
                            type: "post",   //默认为get
                            data: params,   //传递给服务端的数据
                            dataType: "json",
                            cache: false,
                            success: function (data, textStatus) {
                                //console.log(data)
                               
                                    // 添加成功模态框关闭
                                    $("#RecBudget-diologE").dialog("close");
                                    alert("添加操作成功!");
                               

                            },

                            error: function (textStatus, errorThrown) {
                                console.log("系统ajax交互错误: " + JSON.stringify(textStatus));
                            },
                        });
                    

                }
            }
        });
   
</script>