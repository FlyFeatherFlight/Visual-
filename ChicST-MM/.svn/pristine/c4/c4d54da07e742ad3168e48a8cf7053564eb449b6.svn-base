@model IEnumerable<ChicST_MM.WEB.Models.Development_FranchiserTrackLogViewModel>

@{
    ViewBag.Title = "经销商追踪日志列表";
}

<h3>经销商追踪日志列表</h3>
<input type="button" name="" value="添加追踪日志" id="add-New" class="btn btn-primary width-7" style="margin-left:2.5%;margin-bottom:10px;"/>
@*添加*@
<form id="add-diolog">
    <table class="table table-bordered">

        <tr>
            <td>日期</td>
            <td colspan="3">
                <input type="text" name="日期" value="" class="form-control dateTime red" placeholder="请选择日期" oninput="sureRed()" readonly/>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>地点</td>
            <td>
                <input type="text" name="地点" value="" class="form-control red" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>时间</td>
            <td>
                <input type="text" name="时间" value="" class="form-control timeLay red" oninput="sureRed()" placeholder="请选择时间" readonly/>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>类型</td>
            <td>
                <select class="form-control red" name="类型" onchange="sureRed()" >
                    <option value="">-请选择-</option>
                    <option value="去访">去访</option>
                    <option value="接待">接待</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>拜访人</td>
            <td>
                <input type="checkbox" name="" value="" />动态加载
                <input type="text" name="拜访人" value="" class="red" oninput="sureRed()"/>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>拜访内容</td>
            <td colspan="3">
                <textarea rows="3" class="form-control red" name="拜访内容" oninput="sureRed()"></textarea>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>是否了解希可</td>
            <td colspan="3">
                <select class="form-control red" name="是否了解希可" onchange="sureRed()">
                    <option value="">-请选择-</option>
                    <option value="高">高</option>
                    <option value="中">中</option>
                    <option value="低">低</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>半年内看过希可门店</td>
            <td>
                <select class="form-control red" name="半年内看过希可门店" onchange="sureRed()">
                    <option value="">-请选择-</option>
                    <option value=true>是</option>
                    <option value=false>否</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>关注希可超过1年</td>
            <td>
                <select class="form-control" name="关注希可超过一年" onchange="sureRed()">
                    <option value="">-请选择-</option>
                    <option value=true>是</option>
                    <option value=false>否</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>了解程度说明</td>
            <td colspan="3"> 
                <textarea rows="3" class="form-control" name="了解程度说明"></textarea>
            </td>
        </tr>
        <tr>
            <td>意向等级</td>
            <td>
                <select class="form-control red" name="意向等级" onchange="sureRed()">
                    <option value="">-请选择-</option>
                    <option value="高">高</option>
                    <option value="中">中</option>
                    <option value="低">低</option>
                    <option value="无">无</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>结果</td>
            <td>
                <select class="form-control red" name="结果" onchange="sureRed()">
                    <option value="">-请选择-</option>
                    <option value="签订意向合约">签订意向合约</option>
                    <option value="持续跟进">持续跟进</option>
                    <option value="放弃跟进">放弃跟进</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>

        </tr>
        <tr>
            <td>意向描述</td>
            <td colspan="3"><textarea rows="3" class="form-control"  name="意向描述"></textarea></td>
        </tr>
    </table>
</form>
<table class="table table-bordered table-hover">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.日期)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.地点)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.时间)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.类型)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.拜访人)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.拜访内容)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.是否了解希可)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.半年内看过希可门店)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.关注希可超过一年)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.了解程度说明)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.意向等级)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.意向描述)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.结果)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.录入人)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.更新日期)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.经销商)
        </th>
        <th>操作</th>
    </tr>

    @if (Model.Count() > 0)
    {
        foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.日期)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.地点)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.时间)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.类型)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.拜访人)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.拜访内容)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.是否了解希可)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.半年内看过希可门店)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.关注希可超过一年)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.了解程度说明)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.意向等级)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.意向描述)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.结果)
                </td>

                <td>
                    @Html.DisplayFor(modelItem => item.录入人)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.更新日期)
                </td>
                @*<td>
                        @Html.DisplayFor(modelItem => item.经销商ID)
                    </td>*@
                <td>
                    @Html.DisplayFor(modelItem => item.经销商)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.ID }) |
                    @Html.ActionLink("Details", "Details", new { id = item.ID }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.ID })
                </td>
            </tr>
        }
    }
    else
    {

        <tr>
            <td colspan="17" style="height:120px;">暂无数据！</td>
        </tr>

    }
</table>
<script>
    $.ajax({
        url: "@Url.Action("FranchicserContactList", "DevelopmentDoc")",
        data: {id:@ViewBag.ID},
        type: "post",
        dataType: "json",
        success: function (data) {
            console.log(data.data)
            if (data.success) {
              
                
            } else {
                alert(data.msg);
            }
        },
        error: function (err) {
            alert("点击过快或网络错误，请稍后重试！")
            console.log(err);
        }
    })
    $("#add-New").click(function () {
        $("#add-diolog").dialog("option", "title", "添加追踪日志").dialog("open");
    })
      //添加经销商跟进
    $("#add-diolog").dialog({
        autoOpen: false,
        height: 600,
        width: 960,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {
                var reds = $("#add-diolog .red"),
                    status = false;
                $(reds).each(function (i, m) {
                    
                    if (m.value == "" || m.value == null) {
                        return status = true;
                    }
                })
                if (status) {
                    alert("必填项不能为空！");
                } else {
                    $.ajax({
                        url: "@Url.Action("FranchiserTrackLogAdd", "DevelopmentDoc")",
                        data: $("#add-diolog").serialize(),
                        type: "post",
                        dataType: "json",
                        success: function (data) {
                            if (data.success) {
                                $("#add-diolog").dialog("close");
                                alert(data.msg);
                                window.location.reload();
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (err) {
                            alert("点击过快或网络错误，请稍后重试！")
                            console.log(err);
                        }
                    })

                   
                }
            }
        }
    })
</script>