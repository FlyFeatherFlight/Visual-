@model IEnumerable<ChicST_MM.WEB.Models.Development_MarketViewModel>

@{
    ViewBag.Title = "商场";
}

<link href="~/Content/scroolWidth.css" rel="stylesheet" />
<h3>商场</h3>
@Html.ActionLink("添加商场", "MarketAddView", "DevelopmentDoc", new { }, new { style = "margin-left:2.5%;" })
@*<input type="button" onclick="  btn_export('商场列表')" value="导出数据" />*@
<form action="@Url.Action("MarketView","DevelopmentDoc")" method="post" style="margin-left:2.5%;padding:5px 0;">
    查询条件：
    <select class=" search-input" id="sheng">
        <option value="">-请选择省-</option>
    </select>
    <select class="search-input" id="shi" name="cid">
        <option value="">-请选择市-</option>
    </select>
    <select class="search-input" id="_Man" name="emid">
        <option value="">-请选择录入人-</option>
    </select>
    <input type="text" name="startDate" value="" class="search-input dateTime" placeholder="请选择开始日期" readonly />至
    <input type="text" name="endDate" value="" class="search-input dateTime" placeholder="请选择结束日期" readonly />

    <input type="submit" name="" value="查询" />

</form>
@*添加租金年*@
<form id="add-diologY" class="hidden">
    <input type="text" name="商场ID" value="" id="AddID" class="hidden" />
    <table class="table table-bordered table-hover table-striped" style="width:95%;margin:0px auto;">
        <tr>
            <td>租金年</td>
            <td>
                <input type="text" value="" id="yearA" class="form-control year" placeholder="请选择年份" readonly />
            </td>
        </tr>
        <tr>
            <td>租金月</td>
            <td>
                <select value="" id="monthA" class="form-control">
                    <option value="1">1月</option>
                    <option value="2">2月</option>
                    <option value="3">3月</option>
                    <option value="4">4月</option>
                    <option value="5">5月</option>
                    <option value="6">6月</option>
                    <option value="7">7月</option>
                    <option value="8">8月</option>
                    <option value="9">9月</option>
                    <option value="10">10月</option>
                    <option value="11">11月</option>
                    <option value="12">12月</option>
                </select>

            </td>
        </tr>
        <tr>
            <td>租金金额（万元）</td>
            <td>
                <input type="text" name="name" value="" id="moneyA" class="hidden" />
                <input type="text" value="" class="form-control" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" oninput="yearSaleM(this)" placeholder="请输入数字" />
            </td>
        </tr>


    </table>
</form>
@*修改租金年*@
<form id="edit-diologY" class="hidden">
    <input type="text" name="商场ID" value="" id="EditID" class="hidden" />
    <input type="text" name="ID" value="" id="Id" class="hidden" />
    <table class="table table-bordered table-hover table-striped" style="width:95%;margin:0px auto;">
        <tr>
            <td>租金年</td>
            <td>
                <input type="text" name="租金年" value="" id="year" class="form-control year" placeholder="请选择年份" readonly />
            </td>
        </tr>
        <tr>
            <td>租金年</td>
            <td>
                <select name="租金月" value="" id="month" class="form-control">
                    <option value="1">1月</option>
                    <option value="2">2月</option>
                    <option value="3">3月</option>
                    <option value="4">4月</option>
                    <option value="5">5月</option>
                    <option value="6">6月</option>
                    <option value="7">7月</option>
                    <option value="8">8月</option>
                    <option value="9">9月</option>
                    <option value="10">10月</option>
                    <option value="11">11月</option>
                    <option value="12">12月</option>
                </select>

            </td>
        </tr>
        <tr>
            <td>租金金额（万元）</td>
            <td>
                <input type="text" name="租金金额" value="" id="moneyE" class="hidden" />
                <input type="text" name="" value="" id="money" class="form-control" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" oninput="yearSaleM(this)" placeholder="请输入数字" />
            </td>
        </tr>


    </table>
</form>
@*添加联系人*@
<form id="add-diologM" class="hidden">
    <table class="table table-bordered table-hover table-striped" style="width:95%;margin:0px auto;">
        <tr>
            <td>联系人</td>
            <td>
                <input type="text" class="form-control" value="" id="linkManA" />
            </td>
        </tr>
        <tr>
            <td>性别</td>
            <td>
                <select class="form-control" id="genderA">
                    <option value="男">男</option>
                    <option value="女">女</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>职务</td>
            <td>
                <input type="text" class="form-control" value="" id="dutyA" />
            </td>
        </tr>
        <tr>
            <td>联系方式</td>
            <td>
                <input type="text" class="form-control" value="" id="phoneA" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" placeholder="请输入数字" />
            </td>
        </tr>


    </table>
</form>
@*修改联系人*@
<form id="edit-diologM" class="hidden">
    <input type="text" name="商场ID" value="" id="EditIDM" class="hidden" />
    <input type="text" name="ID" value="" id="IdM" class="hidden" />
    <table class="table table-bordered table-hover table-striped" style="width:95%;margin:0px auto;">

        <tr>
            <td>联系人</td>
            <td>
                <input type="text" name="联系人" class="form-control" value="" id="linkMan" />
            </td>
        </tr>
        <tr>
            <td>性别</td>
            <td>
                <select class="form-control" id="gender" name="性别">
                    <option value="男">男</option>
                    <option value="女">女</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>职务</td>
            <td>
                <input type="text" name="职务" class="form-control" value="" id="duty" />
            </td>
        </tr>
        <tr>
            <td>联系方式</td>
            <td>
                <input type="text" name="联系方式" class="form-control" value="" id="phone" />
            </td>
        </tr>


    </table>
</form>
@*修改商场*@
<form id="edit-diolog" class="hidden">
    <input type="text" name="ID" value="" id="editID" class="hidden" />
    <table class="table table-bordered table-hover table-striped" style="width:95%;margin:0px auto;">
        <tr>
            <td>城市</td>
            <td>
                <select class="search-input" id="shengE">
                    <option>-请选择省-</option>
                </select>
                <select class="search-input " id="shiE"></select>
                <span class="must" style="color:red;">*该项为必填项</span>
                <div id="lastCity">
                    上次选中的城市是：
                    <span></span>
                    <input type="text" name="所属城市ID" value="" class="hidden red" />
                </div>
            </td>
            <td>城市等级</td>
            <td>
                <input type="text" class="form-control red" name="城市等级" id="levelE" onpropertychange="sureRed()" autocomplete="off" readonly />
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>商场名称</td>
            <td>
                <input type="text" class="form-control red" id="marketE" name="商场名称" />
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>商场等级</td>
            <td>
                <select class="form-control red" name="商场等级" id="market-levelE">
                    <option value="">-请选择等级-</option>
                    <option value="A+">A+</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>地址</td>
            <td>
                <input type="text" class="form-control " name="地址" id="siteE" />

            </td>
            <td>品牌调整时间</td>
            <td>
                <input type="text" class="form-control dateTime" name="品牌调整时间" id="adjustDateE" />

            </td>
        </tr>
        <tr>
            <td>经营总面积</td>
            <td>
                <input type="text" class="form-control" name="经营总面积" id="totalE" onkeyup="value=value.replace(/[^\d.]/g,'')"
                       onblur="value=value.replace(/[^\d.]/g,'')" placeholder="请输入数字" />
            </td>
            <td>物业名称</td>
            <td>
                <select class="form-control red" name="物业名称" id="realName">
                    <option value="红星美凯龙">红星美凯龙</option>
                    <option value="第六空间">第六空间</option>
                    <option value="喜盈门">喜盈门</option>
                    <option value="居然之家">居然之家</option>
                    <option value="罗浮宫">罗浮宫</option>
                    <option value="其他">其他</option>
                </select>
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
        </tr>
        <tr>
            <td>续约开始日期1</td>
            <td>
                <input type="text" class="form-control dateTime red" id="dateE1" name="续约开始日期1" placeholder="请选择日期" />
                <span class="must" style="color:red;">*该项为必填项</span>
            </td>
            <td>续约开始日期2</td>
            <td>
                <input type="text" class="form-control dateTime" id="dateE2" name="续约开始日期2" placeholder="请选择日期" />
            </td>
        </tr>

    </table>
</form>
<div class="main-wrap">
    <div class="Top hidden">
        <table id="Tab">
            <tr>

                <th>
                    <div class="width-75">所属城市</div>
                </th>
                <th>
                    <div class="width-30">城市等级</div>
                </th>
                <th>
                    <div class="width-102">物业名称</div>
                </th>
                <th>
                    <div class="width-102">商场名称</div>
                </th>
                <th>
                    <div class="width-30">商场等级</div>
                </th>
                <th>
                    <div class="width-102">地址</div>
                </th>
                <th>
                    <div class="width-102">品牌调整时间</div>
                </th>
                <th>
                    <div class="width-410">联系人</div>
                </th>
                <th>
                    <div class="width-102">续约开始日期1</div>
                </th>
                <th>
                    <div class="width-102">续约开始日期2</div>
                </th>
                <th>
                    <div class="width-102">经营总面积</div>
                </th>
                <th>
                    <div class="width-410">租金月</div>
                </th>
                <th>
                    <div class="width-75">录入人</div>
                </th>
                <th>
                    <div class="width-102">更新日期</div>
                </th>
                <th><div class="width-75">操作</div></th>
            </tr>
        </table>
    </div>
     <div class="Botoom" >
        <table class="text-center" id="Table">
            <tr>

                <th>
                    <div class="width-75">所属城市</div>
                </th>
                <th>
                    <div class="width-30">城市等级</div>
                </th>
                <th>
                    <div class="width-102">物业名称</div>
                </th>
                <th>
                    <div class="width-102">商场名称</div>
                </th>
                <th>
                    <div class="width-30">商场等级</div>
                </th>
                <th>
                    <div class="width-102">地址</div>
                </th>
                <th>
                    <div class="width-102">品牌调整时间</div>
                </th>
                <th>
                    <div class="width-410">联系人</div>
                </th>
                <th>
                    <div class="width-102">续约开始日期1</div>
                </th>
                <th>
                    <div class="width-102">续约开始日期2</div>
                </th>
                <th>
                    <div class="width-102">经营总面积</div>
                </th>
                <th>
                    <div class="width-410">租金月</div>
                </th>
                <th>
                    <div class="width-75">录入人</div>
                </th>
                <th>
                    <div class="width-102">更新日期</div>
                </th>
                <th><div class="width-75">操作</div></th>
            </tr>
            @if (Model.Count()> 0)
            {
                foreach (var item in Model)
                {
                    <tr>
                        <td class="Id hidden">@item.ID</td>
                        <td class="shi">
                            @Html.DisplayFor(modelItem => item.所属城市)
                        </td>
                        <td class="cityId hidden">@item.所属城市ID</td>
                        <td class="level">
                            @Html.DisplayFor(modelItem => item.城市等级)
                        </td>
                        <td class="realName">
                            @Html.DisplayFor(modelItem => item.物业名称)
                        </td>
                        <td class="market">
                            @Html.DisplayFor(modelItem => item.商场名称)
                        </td>
                        <td class="market-level">
                            @Html.DisplayFor(modelItem => item.商场等级)
                        </td>
                        <td class="site">
                            @Html.DisplayFor(modelItem => item.地址)
                        </td>
                        <td class="adjustDate date">
                            @Html.DisplayFor(modelItem => item.品牌调整时间)
                        </td>
                        <td>
                            <span class="Aspan" onclick="AddLinkMan(this)">添加联系人</span>
                            @Html.Action("MarketContactView", "DevelopmentDoc", new { id = item.ID })
                        </td>
                        <td class="date1 date">
                            @Html.DisplayFor(modelItem => item.续约开始日期1)
                        </td>
                        <td class="date2 date">
                            @Html.DisplayFor(modelItem => item.续约开始日期2)
                        </td>
                        <td class="total">
                            @Html.DisplayFor(modelItem => item.经营总面积)
                        </td>

                        <td>
                            <span class="Aspan" onclick="Add(this)">添加租金月</span>
                            @Html.Action("MarketRentalView", "DevelopmentDoc", new { id = item.ID })
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.录入人)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.更新日期)
                        </td>
                        <td>
                            <span class="Aspan" onclick="EditMarket(this)">修改</span>
                            <span class="Aspan" onclick="DelMarket(this)">删除</span>

                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="16" style="height:120px;">暂无数据!</td>
                </tr>
            }
        </table>
    </div>
</div>

<script>
    scroollHeadTab();
     //修改商场
    $("#edit-diolog").dialog({
        autoOpen: false,
        height: 600,
        width: 960,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {
                var reds = $("#edit-diolog .red"),
                    status = false;
                $(reds).each(function (i, m) {

                    if (m.value == "" || m.value == null) {
                        return status = true;
                    }
                })
                if (status) {
                    alert("必填项不能为空！");
                } else {
                    $.ajax({
                        url: "@Url.Action("MarketEdit", "DevelopmentDoc")",
                        data: $("#edit-diolog").serialize(),
                        type: "post",
                        dataType: "json",
                        success: function (data) {
                            if (data.success) {
                                alert(data.msg);
                                window.location.reload();
                            } else {
                                alert(data.msg);

                            }
                        },
                        error: function (err) {
                            alert("点击过快或网络错误，请稍后重试！")
                            console.log(err);
                        }
                    })

                    $("#edit-diolog").dialog("close");
                }
            }
        }
    })

     //添加商场租金年
    $("#add-diologY").dialog({
        autoOpen: false,
        height: 300,
        width: 500,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {

                 var objDate = {
                     "商场ID": $("#AddID").val(),
                     "租金年": $("#yearA").val(),
                     "租金月": $("#monthA").val(),
                     "租金金额": $("#moneyA").val(),
                 },
                  datas = [];
            datas.push(objDate);

        $.ajax({
            type: "post",
            data: { lis: JSON.stringify(datas) },
            url: '@Url.Action("MarketRentalAdd", "DevelopmentDoc")',
            dataType: "json",
            cache: false,
            async: true,
            success: function (data) {
                if (data.success) {
                    alert(data.msg);
                    $("#add-diologY").dialog("close");
                    window.location.reload();
                } else {
                    alert(data.msg);
                }
                //console.log(data);
            },
            error: function (err) {
                alert("点击过快或网络错误，请稍后重试！");;
                console.log(err);
            }

        })

            }
        }
    })
      //修改联系人
    $("#edit-diologM").dialog({
        autoOpen: false,
        height: 400,
        width: 600,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {
                $.ajax({
                    url: "@Url.Action("MarketContactEdit", "DevelopmentDoc")",
                    data: $("#edit-diologM").serialize(),
                    type: "post",
                    dataType: "json",
                    success: function (data) {
                        if (data.success) {
                            $("#edit-diologM").dialog("close")
                            alert(data.msg);
                            window.location.reload();
                        } else {
                            alert(data.msg);

                        }
                    },
                    error: function (err) {
                        alert("点击过快或网络错误，请稍后重试！")
                        console.log(err);
                    }
                })


            }
        }
    })
    //修改商场租金年
    $("#edit-diologY").dialog({
        autoOpen: false,
        height: 300,
        width: 500,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {
                $.ajax({
                    url: "@Url.Action("MarketRentalEdit", "DevelopmentDoc")",
                    data: $("#edit-diologY").serialize(),
                    type: "post",
                    dataType: "json",
                    success: function (data) {
                        if (data.success) {
                            $("#edit-diologY").dialog("close");
                            alert(data.msg);
                            window.location.reload();
                        } else {
                            alert(data.msg);

                        }
                    },
                    error: function (err) {
                        alert("点击过快或网络错误，请稍后重试！")
                        console.log(err);
                    }
                })


            }
        }
    })
      //添加联系人
    function AddLinkMan(_this) {
        Id = $.trim($(_this).parent().siblings(".Id").text());
        $("#AddID").val(Id);
        $("#add-diologM").removeClass("hidden").dialog("option", "title", "添加商场联系人").dialog("open");

    }
    //添加商场联系人
    $("#add-diologM").dialog({
        autoOpen: false,
        height: 400,
        width: 600,
        modal: true,
        buttons: {

            "取消": function () { $(this).dialog("close") },
            "提交": function () {

                 var objDate = {
                     "商场ID": $("#AddID").val(),
                     "联系人": $("#linkManA").val(),
                     "性别": $("#genderA").val(),
                     "职务": $("#dutyA").val(),
                     "联系方式": $("#phoneA").val(),
                 },
                  datas = [];
            datas.push(objDate);

        $.ajax({
            type: "post",
            data: { lis: JSON.stringify(datas) },
            url: '@Url.Action("MarketContactAdd", "DevelopmentDoc")',
            dataType: "json",
            cache: false,
            async: true,
            success: function (data) {
                if (data.success) {
                    alert(data.msg);
                    $("#add-diologM").dialog("close");
                    window.location.reload();
                } else {
                    alert(data.msg);
                }
                //console.log(data);
            },
            error: function (err) {
                alert("点击过快或网络错误，请稍后重试！");;
                console.log(err);
            }

        })

            }
        }
    })
    //获取员工数据
    getMan($("#_Man"));
    //根据是否滚动显示表头
    scroollHeadTab
    //转换租金金额
    $(".tabMoney .money").each(function (i, m) {
        $(m).text($(m).text() / 10000);
    })
    //转换日期格式
    dateTab($(".date"));
   
     //获取省份数据
    $.ajax({
        type: "post",
        data: {},
        url: '@Url.Action("GetProvince", "DevelopmentDoc")',
        dataType: "json",
        cache: false,
        async: true,
        success: function (data) {
            $.each(data, function(i, m) {
                $("#sheng").append("<option value=" + m + ">" + m + "</option>");
                $("#shengE").append("<option value=" + m + ">" + m + "</option>");

            })

        },
        error: function (err) {
            alert("点击过快或网络错误，请稍后重试！");;
            console.log(err);
        }

    })

    //根据选择的省份，获取市数据
    /****查询***/
    $("#sheng").change(function () {
        $("#shi").empty();
        getShi($("#sheng").val(), $("#shi"));
    })

    /****修改***/
    $("#shengE").change(function () {
        $("#lastCity span").text("");
        $("#lastCity input").val("");
        $("#level").val("");
        $("#shiE").empty();
        getShi($("#shengE").val(), $("#shiE"));
    })
    //根据当前选择的城市加载商场下拉框 并给城市等级赋值

    //修改
    $("#shiE").change(function () {
        $("#lastCity input").val($("#shiE").val());
        //为城市分级赋值
        //调用选中文本
        activeText($("#shiE"));
        var level = $("#shiE").find("option.active").data("level");
        $("#levelE").val(level);

    })
  

     //修改
    function EditMarket(_this) {
            //给修改模态框赋值
        var shi = $.trim($(_this).parent().siblings(".shi").text()),
            level = $.trim($(_this).parent().siblings(".level").text()),
            market = $.trim($(_this).parent().siblings(".market").text()),
            marketLevel = $.trim($(_this).parent().siblings(".market-level").text()),
            site = $.trim($(_this).parent().siblings(".site").text()),
            adjustDate = $.trim($(_this).parent().siblings(".Area").text()),
            principal = $.trim($(_this).parent().siblings(".principal").text()),
            Phone = $.trim($(_this).parent().siblings(".Phone").text()),
            duty = $.trim($(_this).parent().siblings(".duty").text()),
            date1 = $.trim($(_this).parent().siblings(".date1").text()),
            date2 = $.trim($(_this).parent().siblings(".date2").text()),
            total = $.trim($(_this).parent().siblings(".total").text()),
            realName = $.trim($(_this).parent().siblings(".realName").text()),
            adjustDate = $.trim($(_this).parent().siblings(".adjustDate").text()),


            Id = $.trim($(_this).parent().siblings(".Id").text());
            cityId = $.trim($(_this).parent().siblings(".cityId").text());
        if (market =="-请选择商场-") {
            market = "";
        }
        common($("#market-levelE option"), marketLevel);
        common($("#realName option"), realName);
        $("#lastCity span").text(shi);
        $("#lastCity input").val(cityId);
        $("#levelE").val(level);
        $("#marketE").val(market);

        $("#siteE").val(site);
        $("#adjustDateE").val(adjustDate);

        $("#principalE").val(principal);
        $("#PhoneE").val(Phone);
        $("#dutyE").val(duty);
        $("#dateE1").val(date1);
        $("#dateE2").val(date2);
        $("#totalE").val(total);

        $("#editID").val(Id);

        $("#edit-diolog").removeClass("hidden").dialog("option", "title", "修改商场").dialog("open");
    }

   
    //传给后台修改价格 租金年
    function yearSaleM(_this) {
        var money = $(_this).val() * 10000;
        $(_this).prev().val(money);
    }

    //添加租金年
    function Add(_this) {
        Id = $.trim($(_this).parent().siblings(".Id").text());
        $("#AddID").val(Id);
        $("#add-diologY").removeClass("hidden").dialog("option", "title", "添加商场租金年").dialog("open");

    }
   
     //修改租金年
    function Edit(_this) {

        var money = $.trim($(_this).parent().siblings(".money").text()),
            year = $.trim($(_this).parent().siblings(".year").text()),
            month = $.trim($(_this).parent().siblings(".month").text()),
            Id = $.trim($(_this).parent().siblings(".Id").text());
        shopId = $.trim($(_this).parent().siblings(".shopId").text());

        //给修改模态框赋值
        $("#year").val(year);
        common($("#month option"), month);
        $("#money").val(money);
        $("#moneyE").val(money*10000);
        $("#Id").val(Id);
        $("#EditID").val(shopId);
        $("#edit-diologY").removeClass("hidden").dialog("option", "title", "修改商场租金年").dialog("open");
    }
     

     //修改联系人
    function EditLinkMan(_this) {

        var linkMan = $.trim($(_this).parent().siblings(".linkMan").text()),
            gender = $.trim($(_this).parent().siblings(".gender").text()),
            duty = $.trim($(_this).parent().siblings(".duty").text()),
            phone = $.trim($(_this).parent().siblings(".phone").text()),
            Id = $.trim($(_this).parent().siblings(".Id").text());
        shopId = $.trim($(_this).parent().siblings(".shopId").text());

        //给修改模态框赋值
        $("#linkMan").val(linkMan);
        common($("#gender option"), gender);
        $("#duty").val(duty);
        $("#phone").val(phone);
        $("#IdM").val(Id);
        $("#EditIDM").val(shopId);
        $("#edit-diologM").removeClass("hidden").dialog("option", "title", "修改商场联系人").dialog("open");
    }
   

    //删除商场
    function DelMarket(_this) {
        var id = $.trim($(_this).parent().siblings(".Id").text()),
            del = $(_this).parent().parent();
         $.ajax({
                type: "post",
                data: { id: id },
                url: '@Url.Action("MarketDel", "DevelopmentDoc")',
                dataType: "json",
                cache: false,
                async: true,
             success: function (data) {
                 //console.log(data);
                 if (data.success) {
                     alert(data.msg);
                     $(del).remove();
                 } else {
                     alert(data.msg);
                 }

                },
                error: function (err) {
                    alert("点击过快或网络错误，请稍后重试！");;
                    console.log(err);
                }

            })


    }
     //租金删除
     function Del(_this) {
         var id = $.trim($(_this).parent().siblings(".Id").text()),
             del = $(_this).parent().parent();
         $.ajax({
                type: "post",
             data: { id: id },
                url: '@Url.Action("MarkestRentalDel", "DevelopmentDoc")',
                dataType: "json",
                cache: false,
                async: true,
             success: function (data) {
                 //console.log(data);
                 if (data.success) {
                     alert(data.msg);
                   $(del).remove();
                 } else {
                     alert(data.msg);
                 }

                },
                error: function (err) {
                    alert("点击过快或网络错误，请稍后重试！");;
                    console.log(err);
                }

            })


    }
     //联系人删除
    function DelLinkMan(_this) {
         var id = $.trim($(_this).parent().siblings(".Id").text()),
             del = $(_this).parent().parent();
         $.ajax({
            type: "post",
            data: { id: id },
            url: '@Url.Action("MarketContactDel", "DevelopmentDoc")',
            dataType: "json",
            cache: false,
            async: true,
            success: function (data) {
                 //console.log(data);
                 if (data.success) {
                     alert(data.msg);
                   $(del).remove();
                 } else {
                     alert(data.msg);
                 }

                },
                error: function (err) {
                    alert("点击过快或网络错误，请稍后重试！");;
                    console.log(err);
                }

            })


    }
    //获取市
    function getShi(province, shi ) {
         $.ajax({
                type: "post",
                data: { province: province },
                url: '@Url.Action("GetRgion", "DevelopmentDoc")',
                dataType: "json",
                cache: false,
                async: true,
             success: function (data) {
                    //console.log(data)
                 shi.append("<option value='' class='active'> -请选择- </option>");
                    $.each(data, function(i, m) {
                        $.each(m, function (n, d) {
                            shi.append("<option data-level='" + d.Level+"' value='" + d.ID + "'>" + d.City + "</option>")
                        })
                    })
                },
                error: function (err) {
                    alert("点击过快或网络错误，请稍后重试！");;
                    console.log(err);
                }

            })
    }


    // 获取选中时的文本 添加.active
    function activeText(Jopts) {

            var value = Jopts.val();//这个值就是你获取的值;
            if (value != "") {
                for (var i = 0; i < Jopts.find("option").length; i++) {
                    if (value == Jopts.find("option")[i].value) {

                        if ($(Jopts.find("option")[i]).hasClass("active")) {
                            return;
                        } else {
                            $(Jopts.find("option")[i]).siblings().removeClass("active")
                            $(Jopts.find("option")[i]).addClass("active");

                        }
                        break;
                    }
                }
            }

    }
    //修改时给下拉框添加.selected
    function common(option, Name) {

        if (Name != "" || Name != null) {
            var options = option;
            $(options).each(function (i, m) {
                if (Name == m.value) {

                    $(m).attr("selected", "selected")
                }
            })
        }
    }


</script>